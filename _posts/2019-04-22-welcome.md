---
layout: post
title: Welcome to my Blog!!
categories: [malware, general, analysis]
tags: [autoit, malware, colombia, njrat]
fullview: true
comments: true
---

Welcome to my personal blog!! with the following post I will start a series of detailed malware analysis and explainaitions of some malware analysis techniques/tools. 

The analyzed sample was a trojan detected in Colombia targeting multiple users, including corporate users and small company owners. The initial sample was obtained from a phishing email, attempting to impersonate some Colombian government institutions such as “Ministerio de Transporte” (Colombia’s department of transportation) with an attachment or a download link. The download link is typically a direct download link for cloud services like OneDrive, Google Drive, DropBox, etc.

A copy of the malware and a quick dynamic analysis can be seen [here](https://app.any.run/tasks/90f4cda6-b4b6-4c56-9495-05695218e0a2) 

## Analyzing the downloaded file:

The downloaded file is compressed using  TAR Z, which can be extracted using common software such as WinRAR, only contains one executable that use a PDF icon most likely to lure the user into executing the file. This kind of extensions is a well know method to avoid quick detections and extension blocks on most common firewall/antivirus/email configurations, allowing the attackers reach more targets. Also they tend to use larger file names in order to “hide” the extension on the default configuration of windows file explorer. 

### Dynamic Analysis:

Most of the time that I analyze public samples I prefer to run an initial dynamic analysis using an online sandbox tool such as [hybrid-analysis](https://www.hybrid-analysis.com/) or [app.any.run](https://app.any.run/) that allows me to quickly get an idea of what actions the malware may do and also it can extract useful information such as IoCs that can help determine if another user on the network could be infected. Currently my favorite free sandbox is **app.any.run** as it provides a really good user interface and support multiple machine options fake net (force the malware fail any connection by returning 404), tor routed traffic, etc.

As you could see from the previously shared link with the sample, the test i made for this analysis was a simple VM with Windows 7 and normal internet connection, uploaded the sample and executed. Once the VM was started i used the “Add time” button to extend the test to the maximum free execution time of 380 secs in order to see as much behaviours of the malware as I could.

Looking at the results after the analysis runs out of execution time we can clearly see the malware is spawning multiple proccess 

![spwned process]({{ site.baseurl }}/images/1/1.png "Spawned Process by the Malware")

What **app.any.run** shows here is that after running WinRAR the process “Circular… .Exe” was also initiated, that process spawned a child process named RegAsm.exe and executed schtasks.exe with a param. After that multiple instances of the BlbEvents.exe process where initiated and did almost the same as “Circular… .Exe". 

Clicking on the schtask.exe process and then on the **more info** button let us get more information about the process, such as modified files , connections made, complete command executed, modules loaded, etc. Now let's take a closer look at the complete command executed for this process:

```
"C:\Windows\System32\schtasks.exe" /create /tn aadauthhelper /tr "C:\Users\admin\AppData\Roaming\certcli\BlbEvents.exe" /sc minute /mo 1 /F
```


